import{a as f}from"./authGuard-DaSBCqor.js";import{G as g,h as T}from"./headers-Dul6VsrZ.js";import{h as w}from"./create-D26iuoUm.js";function S(s){const e=s.target.closest(".my-post").dataset.id;window.location.href=`/post/edit/?id=${e} `}function v(){localStorage.removeItem("accessToken"),window.location.href="/auth/"}function P(){document.getElementById("logout-button").addEventListener("click",v)}async function C(s){try{const e=await fetch(`${g}${s}`,{method:"DELETE",headers:T()});if(e.ok)alert("Post deleted successfully"),window.location.href="/profile/";else{const a=await e.json();throw new Error(a.message||"Failed to delete post")}}catch(e){w(e)}}function _(s){const e=s.target.dataset.id;C(e)}f();P();class L{constructor(e,a){const t=document.createElement("div");t.classList.add("individual-post-box"),t.classList.add("post-container-mobile"),t.classList.add("post-container-desktop");const n=document.createElement("div"),o=document.createElement("div"),d=document.createElement("h2"),m=document.createElement("p"),E=document.createElement("div"),u=document.createElement("div"),h=document.createElement("p"),r=document.createElement("img");r.classList.add("post-image");const p=document.createElement("div"),i=document.createElement("button");return i.textContent="View post",i.classList.add("button-mobile"),i.classList.add("button-desktop"),d.textContent=e.title||"No title available",m.textContent=e.body||"No content available",h.textContent=e.tags?e.tags.join(", "):"No tags available",e.media?.url?r.src=e.media.url:r.alt="No image available",p.appendChild(i),n.appendChild(o),n.appendChild(E),n.appendChild(u),o.appendChild(d),E.appendChild(m),u.appendChild(h),u.innerHTML=`<strong>Tags:</strong> ${u.innerHTML}`,t.appendChild(r),a.appendChild(n),a.appendChild(t),a.appendChild(p),r.addEventListener("click",()=>{window.location.href=`/post/?id=${e.id}`}),i.addEventListener("click",()=>{window.location.href=`/post/?id=${e.id}`}),t}}class B extends L{constructor(e,a){const t=super(e,a),n=document.createElement("button"),o=document.createElement("button"),d=document.createElement("div");return t.classList.add("my-post"),n.textContent="Edit",o.textContent="Delete",t.dataset.id=e.id,n.addEventListener("click",m=>{S(m)}),o.dataset.id=e.id,n.classList.add("edit-button"),o.classList.add("delete-button"),o.addEventListener("click",_),d.appendChild(n),d.appendChild(o),t.appendChild(d),t}}async function I(){try{if(!localStorage.getItem("accessToken"))throw new Error("No access token found. Please log in.");const e=await fetch("https://v2.api.noroff.dev/social/posts?_tag=MEYERAPP",{method:"GET",headers:T()});if(!e.ok)throw console.error("HTTP error response:",e),new Error(`HTTP error! status: ${e.status||"unknown"}`);const a=await e.json(),t=a.data.sort((o,d)=>new Date(d.created)-new Date(o.created)).slice(0,12);localStorage.setItem("posts",JSON.stringify(a.data));const n=document.getElementById("posts-container");n&&(n.innerHTML="",t.forEach(o=>{try{new L(o,n)}catch(d){console.error("Error creating post elements:",d,o)}}))}catch(s){console.error("Error fetching posts:",s)}}I();const N=document.querySelector(".hamburger-menu"),c=document.querySelector(".nav-menu"),O=()=>{window.innerWidth>=641?(c.classList.remove("hidden"),c.classList.add("flex")):(c.classList.add("hidden"),c.classList.remove("flex"))};O();N.addEventListener("click",()=>{window.innerWidth<641&&(c.classList.toggle("hidden"),c.classList.toggle("block"))});window.addEventListener("resize",O);const b=document.querySelector(".create-post-button"),l=document.querySelector(".create-post-form");b.addEventListener("click",()=>{l.classList.contains("hidden")?(l.classList.remove("hidden"),l.classList.add("show")):(l.classList.remove("show"),l.classList.add("hidden"))});export{L as CreateAllPostElements,B as CreateMyPostsElements,I as getAllPosts};
